import os
import re

FOLDER = "files"
SIGNATURES = [
    r"eval\(",
    r"base64\.b64decode",
    r"socket\.connect",
    r"exec\(",
    r"import os"
]

def scan_file(filepath):
    with open(filepath, "r", errors="ignore") as f:
        content = f.read()

    alerts = []
    for sig in SIGNATURES:
        if re.search(sig, content):
            alerts.append(sig)

    return alerts

for filename in os.listdir(FOLDER):
    path = os.path.join(FOLDER, filename)
    if os.path.isfile(path):
        found = scan_file(path)
        if found:
            print(f"[ALERT] Suspicious patterns detected in {filename}: {found}")
